//===== rAthena Script =======================================
//= AI Quest Giver Example - Advanced Hybrid System
//===== Description: =========================================
//= Advanced example showing context-aware AI dialogue
//= Demonstrates player state tracking and dynamic responses
//===== Author: ==============================================
//= rAthena AI World Team
//============================================================

prontera,155,150,4	script	AI Quest Giver#example	4_F_SISTER,{
	// Check if player has talked to this NPC before
	.@first_time = (getd(".talked_" + getcharid(0)) == 0);
	
	if (.@first_time) {
		// First-time greeting
		mes "[Sister Maria]";
		mes "Oh, a new face! Welcome, adventurer.";
		mes "I'm Sister Maria, and I help travelers like you.";
		mes "^FF0000You can ask me questions by typing them!^000000";
		setd(".talked_" + getcharid(0), 1);
		next;
	} else {
		// Returning player
		mes "[Sister Maria]";
		mes "Welcome back, " + strcharinfo(0) + "!";
		next;
	}
	
	// Main dialogue loop
	while(1) {
		mes "[Sister Maria]";
		mes "What brings you here today?";
		next;
		
		// Build dynamic menu based on player state
		.@menu$ = "";
		.@menu$ += "Ask about available quests:";
		.@menu$ += "Ask about my current progress:";
		
		// Add level-specific options
		if (BaseLevel >= 50) {
			.@menu$ += "Tell me about advanced content:";
		}
		
		// Always include AI chat and exit
		.@menu$ += "Type your own question ⌨️:";
		.@menu$ += "Goodbye";
		
		.@choice = select(.@menu$);
		
		// Handle menu selection
		if (.@choice == 1) {
			// Available quests
			mes "[Sister Maria]";
			mes "Let me check what quests are suitable for you...";
			next;
			
			mes "[Sister Maria]";
			mes "Based on your level (" + BaseLevel + "), here are some quests:";
			
			if (BaseLevel < 30) {
				mes "- ^0000FFBeginner's Training^000000 (Level 1-30)";
				mes "- ^0000FFGathering Herbs^000000 (Level 10+)";
			} else if (BaseLevel < 60) {
				mes "- ^0000FFMonster Hunting^000000 (Level 30-60)";
				mes "- ^0000FFDelivery Service^000000 (Level 40+)";
			} else {
				mes "- ^0000FFDungeon Exploration^000000 (Level 60+)";
				mes "- ^0000FFBoss Hunting^000000 (Level 70+)";
			}
			next;
			
		} else if (.@choice == 2) {
			// Current progress
			mes "[Sister Maria]";
			mes "Let me see your progress...";
			next;
			
			mes "[Sister Maria]";
			mes "^0000FFYour Status:^000000";
			mes "Level: " + BaseLevel + " / " + JobLevel;
			mes "Job: " + jobname(Class);
			mes "Zeny: " + Zeny + "z";
			next;
			
		} else if (BaseLevel >= 50 && .@choice == 3) {
			// Advanced content (only if level 50+)
			mes "[Sister Maria]";
			mes "Ah, you're strong enough for advanced content!";
			mes "Have you tried the War of Emperium?";
			mes "Or perhaps the Memorial Dungeons?";
			next;
			
		} else if (.@choice == (BaseLevel >= 50 ? 4 : 3)) {
			// AI-powered free-form question
			mes "[Sister Maria]";
			mes "Of course! Ask me anything you'd like to know.";
			mes "^0000FF(Type your question below)^000000";
			next;
			
			// Enable AI dialogue mode
			ai_chat_start("quest_giver_maria");
			input .@dummy$;
			
			// AI will respond asynchronously
			close;
			
		} else {
			// Goodbye
			mes "[Sister Maria]";
			mes "May the blessings of the goddess be with you!";
			close;
		}
	}
}

