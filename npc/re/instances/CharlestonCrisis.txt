//===== rAthena Script ======================================= 
//= Charleston Crisis Instance 'Episode 15.1'  (kRO Servers)
//===== By: ================================================== 
//= Ziu
//===== Current Version: ===================================== 
//= 1.3 (Spanish Scene)
//===== Compatible With: ===================================== 
//= rAthena TRUNK 17454 + data Rev z.432
//===== Additional Comments: ================================= 
//= [AEGIS Playing Conversion]
//= Official Korean Texts [Ziu]
//= 1.0 First Version [Ziu]
//= 1.1 Change method script add instance check id [Ziu]
//= 1.2 Fix severals bugs [Ziu]
//= 1.3 Translated to Spanish [DanielArt]
//= 1.4 Translated to English + logical restructuration [Alayne]
//= 1.5 Added Hercules support
//============================================================

verus04,75,114,5	script	Charleston#charleston2	4_F_CHARLESTON02,{
	//RATHENA
	if (checkquest(13186) == -1) {
	//HERCULES
	//if (questprogress(13186) == 0) {
		cutin "nale01.bmp",0;
		mes "[Charleston]";
		mes "No changes in the past, but an opaque future raise. I can give you the opportunity to go out and see the real disappointment, I do not dare to do so.";
		cutin "nale03.bmp",0;
		next;
		switch(select("There is hope, I'll take the challenge","No thanks"))
		{
			case 1:
				//RATHENA
				if ((checkquest(13184) == 0) || (checkquest(13184) == 1) || (checkquest(13184) == 2)) {
				//HERCULES
				//if ((questprogress(13184) == 1) || (questprogress(13184) == 2)) {
					mes "[Charleston]";
					mes "I will do my best to finish, even if the possibility is a million to one, it is unlikely, even without him.";
					cutin "", 255;
				} else {
					mes "[Charleston]";
					mes "Hi ... human robot. I do not care that you are rational and efficient, but today is a certain day.";
					next;
					mes "[Charleston]";
					mes "Ironically, I never expected anyone 'rational' to come to challenge this being, your efforts will be necessary to see a real change on the planet.";
					next;
					mes "[Charleston]";
					mes "I would love to help you, even without any responsibility. However, I will place my trust in you, even if the possibility is minimal.";
					next;
					mes "[Charleston]";
					mes "Even when my heart stops, I know that my trust is deposited with you.";
					setquest 13184;
					cutin "", 255;
				}
				close;
			case 2:
				//RATHENA
				if ((checkquest(13184) == 1) || (checkquest(13184) == 0) || (checkquest(13184) == 2)) {
				//HERCULES
				//if ((questprogress(13184) == 1) || (questprogress(13184) == 2)) {
					close2;
					erasequest 13184;
				}
				cutin "", 255;
				close;
		}
	} else {
		mes "[Charleston]";
		mes "Thank you for your help, loved to be. I know now that a better future awaits the planet.";
		next;
		mes "[Charleston]";
		mes "Even when our city is in desolation, a promising future awaits you.";
		getexp 1800000,600000;
		setquest 13185;
		erasequest 13184;
		erasequest 13186;
		close;
	}
}
verus04,81,113,1	script	Teleport Machine#machine	PORTAL,{
	if (BaseLevel < 130) {
		mes "^ff0000It is not yet time for you to enter here, go and gain more experience.^000000";
		close;
	}
	//if the instance quest isn't set, check for reentering one
	//RATHENA
	set .@can_enter, checkquest(13184);
	if (.@can_enter == 0 || .@can_enter == 1) {
		set .@charleston_time,checkquest(13185,PLAYTIME); //20 hours
	//HERCULES
	//set .@can_enter, questprogress(13184);
	//if (.@can_enter == 1) {
		//set .@charleston_time,questprogress(13185,PLAYTIME); //20 hours
		//if delay has been overrun
		if (.@charleston_time == 2) {
			//remove it
			erasequest 13185;
			mes "^ff0000Looks like you're ready to enter again, hu?^000000";			
			close;
		}
		//RATHENA
		else  if (.@charleston_time == 1 || .@charleston_time == 0) {
		//HERCULES
		//else if (.@charleston_time == 1) {
			mes "^ff0000It is not yet time for you to enter here, go and gain more experience.^000000";
			close;
		}
		//RATHENA
		else {
		//HERCULES
		//else if (.@charleston_time == 0) {
			set .@party_id,getcharid(1);
			set .@p_name$,getpartyname(.@party_id);
			set .@md_name$,"Charleston Crisis";
			
			if (!instance_check_party(.@party_id,1)) {
				mes "You don't have enough team members.";
				close;
			}
			if (getcharid(0) == getpartyleader(.@party_id,2))
				set .@menu$, (.@charleston_time == -1 ? "Create Charleston Crisis" : "") + ":" + (.@charleston_time != -1 ? "Enter Charleston Crisis" : "")+ ":Leave";
			else
			{
				if(.@can_enter == -1)
				{
					mes "I can do nothing for you, sorry.";
					close;
				}
				set .@menu$, ":Enter Charleston Crisis.";
			}
			switch(select(.@menu$)) 
			{
				case 1:
					//RATHENA
					set .@instance, instance_create(.@md_name$);
					//HERCULES
					//set .@instance, instance_create(.@md_name$, .@party_id, IOT_PARTY);
					if (.@instance < 0) {
						mes "Party's name: "+.@p_name$;
						mes "Leader's name: "+strcharinfo(0);
						mes "^0000ff"+.@md_name$+" ^000000- Can't create instance!";
						close;
					}
					//HERCULES
					//setarray .@maps$[0], "1@mcd";
					//for( set .@i, 0; .@i < getarraysize(.@maps$); set .@i,.@i+1 )
					//{
					//	if( instance_attachmap( .@maps$[.@i],.@instance ) == "" ){
					//		setmapflag .@maps$[.@i],mf_zone,"Memorial Dungeon";
					//		npctalk "Charleston Crisis reservation failed due to map attach failure.";
					//		mes "- ^FF0000Reservation Failed!^000000";
					//		instance_destroy( instance_id() );
					//		close;
					//	}
					//}
					//instance_set_timeout 7200,300,.@instance;
					//instance_init(.@instance);
					
					mes "^ff0000Portal opened!^000000";
				case 2:
					getmapxy(.@map$, .@x, .@y, UNITTYPE_PC);
					save .@map$, .@x, .@y;
					//RATHENA
					switch(instance_enter(.@md_name$))
					{
						case 0:
							mes "[Teleport Machine]";
							mes "Get ready to enter!";
							mapannounce "verus04",strcharinfo(0)+", member of the party "+.@p_name$+" entered the instance "+.@md_name$+".",bc_map,"0x00ff99";
							setquest 13185;
							specialeffect2 EF_WARP;								
							if(charlestonins != 0) {
								set charlestonins,0;
							}
							close;
						case 1:
							mes "Only the registered members can enter the instance "+.@md_name$+".";
							close;
						case 2:
							mes "The memorial dungeon "+.@md_name$+" does not exist.";
							mes "The party leader did not generate the dungeon yet.";
							close;
						case 3:
							mes "Unknown Error...!";
							close;
					}
					//HERCULES
					//if( has_instance( "1@mcd" ) == "" ){
					//    mes "Charleston Crisis doesnt exist for Party - "+getpartyname( .@party_id );
					//}
					//else{
					//	if (getcharid(0) == getpartyleader(.@party_id,2)) {
					//		setquest 13185;
					//	}
					//	set charlestonins,0;
					//	mapannounce "verus04",strcharinfo(0)+", member of the party "+.@p_name$+" entered the instance "+.@md_name$+".",bc_map,"0x00ff99";
					//	setquest 13185;
					//	specialeffect2 EF_WARP;
					//	sleep2 1000;
					//  instance_announce has_instance2( "1@mcd" ), strcharinfo(0) + " from party, " +getpartyname( .@party_id )+", is entering the Charleston Crisis instance.",bc_map,"0x00FF99",FW_NORMAL,12;
					//  warp "1@mcd",127,282;
					//}
				case 3:
					close;	
			}
		}
	} else {
		mes "^ff0000Error, you don't have access to the Portal.^000000";
		close;
	}
}
//NPC Instance, Quest And Reward
//==================================

1@mcd,127,277,4	script	Charleston#0_00y	4_F_CHARLESTON01,10,2,{
	end;
OnTouch:
	if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#0_00y"))) == 1) {
		cutin "dalle01.bmp",2;
		mes "[Charleston]";
		mes "Good luck and watch out front.";
		close2;
		cutin "dalle01.bmp",255;
		end;
	} else {
		if (getcharid(0) == getpartyleader(getcharid(1),2)) {
			mes "[Charleston]";
			mes "A number of robots have appeared in front of us, we are busy helping you eliminate them.";
			npctalk "A number of robots have appeared in front of us, we are busy helping you eliminate them.";
			cutin "dalle01.bmp",2;
			emotion ET_SURPRISE;
			next;
			mes "[Charleston]";
			mes "Apparently something or someone has been controlling to the maximum creation of this factory of robots, that one day in the past was the one that gave life to Juperos.";
			npctalk "Apparently something or someone has been controlling to the maximum creation of this factory of robots, that one day in the past was the one that gave life to Juperos.";
			next;
			mes "[Charleston]";
			mes "It is said that the name of this maximum creation was Charleston.";
			npctalk "It is said that the name of this maximum creation was Charleston.";
			emotion ET_PROFUSELY_SWEAT;
			next;
			mes "[Charleston]";
			mes "Please help us know what happens to Charleston.";
			npctalk "Please help us know what happens to Charleston.";
			emotion ET_PROFUSELY_SWEAT;
			setd "."+instance_id(),1;
			close2;
			donpcevent instance_npcname("Charleston#0_00y", instance_id()) + "::OnAnnounce";
			cutin "dalle01.bmp",255;
			end;
		} else {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "Be very careful and lucky in front.";
			close2;
			cutin "dalle01.bmp",255;
			end;
		}
	}
OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnAnnounce:
	initnpctimer;
	end;
OnTimer5000:
	instance_announce instance_id(),"Beat the uncontrolled robots and arrive with the scientist and sisters Charleston.",bc_map,"0xFFFF00";
	stopnpctimer;
	end;
}

1@mcd,116,213,5	script	Scientist#1_00y	4_M_DOCTOR,2,3,{
	if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 0) {
		mes "Help us with the robots please.";
		close;
	}
	else if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) > 0) {
		mes "Give us your power to see what happens to the great Charleston robot..";
		close;
	}
OnTouch:
	if (getcharid(0) == getpartyleader(getcharid(1),2)) {
		if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 0) {
			mes "[Scientist]";
			mes "I'm glad you finally got to this point..";
			npctalk "I'm glad you finally got to this point.";
			next;
			cutin "dalle02.bmp",2;
			mes "[Charleston]";
			mes "Please Father, tell these brave adventurers what to do.";
			donpcevent instance_npcname("Charleston#1_00y", instance_id()) + "::OnChat1";
			next;
			cutin "dalle01.bmp",255;
			mes "[Scientist]";
			mes "Well, apparently a big virus has entered this old factory, and I, as the responsible builder, find myself here ...";
			npctalk "Well, apparently a big virus has entered this old factory, and I, as the responsible builder, find myself here ...";
			next;
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "All the robots that father has built have gone crazy.";
			donpcevent instance_npcname("Charleston#1_00y", instance_id()) + "::OnChat2";
			next;
			switch(select("And ... what can I do to help?"))
			{
				case 1:
					mes "[Charleston]";
					mes "Sure, help us with your great power to defeat the viruses that have infiltrated the beautiful father robots.";
					donpcevent instance_npcname("Charleston#1_00y", instance_id()) + "::OnChat3";
					next;
					mes "[Charleston]";
					mes "If we do not stop them in time the factory could collapse.";
					donpcevent instance_npcname("Charleston#1_00y", instance_id()) + "::OnChat4";
					next;
					cutin "dalle01.bmp",255;
					mes "[Scientist]";
					mes "First we have to deactivate the security system.";
					npctalk "First we have to deactivate the security system.";
					next;
					cutin "dalle01.bmp",2;
					mes "[Charleston]";
					mes "The security system are robots that monitor the area, so we take your help.";
					donpcevent instance_npcname("Charleston#1_00y", instance_id()) + "::OnChat5";
					next;
					switch(select("Let's go for that security system!","No thanks"))
					{
						case 1:
							mes "[Charleston]";
							mes "Okay, please come with me to tell you where the robots in the security system are located.";
							donpcevent instance_npcname("Charleston#1_00y", instance_id()) + "::OnChat8";
							close2;
							cutin "dalle01.bmp",255;
							end;
						case 2:
							close;
					}
			}
		}
	}
	end;
	
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "This gear is full of scrap metal.";
	end;
}

1@mcd,121,217,4	script	Charleston#1_00y	4_F_CHARLESTON01,{
	if (getcharid(0) == getpartyleader(getcharid(1),2)) {
		if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 0) {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "Thank you for your efforts to discover the laboratory problem..";
			close2;
			cutin "dalle01.bmp",255;
			end;
		}
		else if((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 1) {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "Okay, first we must destroy the robots of the security system in order to work quietly.";
			npctalk "Okay, first we must destroy the robots of the security system in order to work quietly.";
			next;
			mes "[Charleston]";
			mes "Charleston is protected by a complex security system, so if we do not disable it we will have nothing more to do.";
			npctalk "Charleston is protected by a complex security system, so if we do not disable it we will have nothing more to do.";
			next;
			mes "[Charleston]";
			mes "It will be enough to destroy the robots of the security system to fulfill your work.";
			npctalk "It will be enough to destroy the robots of the security system to fulfill your work.";
			next;
			mes "[Charleston]";
			mes "I will indicate in your map the coordinates where these robots are to destroy them.";
			npctalk "I will indicate in your map the coordinates where these robots are to destroy them.";
			next;
			setd "."+instance_id(),2;
			emotion ET_QUESTION;
			donpcevent instance_npcname("#systemsecurity", instance_id()) + "::OnEnable";
			viewpoint 1,84,226,0,0x00FF00;
			viewpoint 1,126,84,1,0x00FF00;
			viewpoint 1,111,68,2,0x00FF00;
			viewpoint 1,210,181,3,0x00FF00;
			viewpoint 1,183,192,4,0x00FF00;
			viewpoint 1,130,124,5,0x00FF00;
			viewpoint 1,54,108,6,0x00FF00;
			close2;
			cutin "dalle01.bmp",255;
			end;
		}
		else if((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 2) {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "Please destroy the security robots to continue, I have marked the points on the map.";
			viewpoint 1,84,226,0,0x00FF00;
			viewpoint 1,126,84,1,0x00FF00;
			viewpoint 1,111,68,2,0x00FF00;
			viewpoint 1,210,181,3,0x00FF00;
			viewpoint 1,183,192,4,0x00FF00;
			viewpoint 1,130,124,5,0x00FF00;
			viewpoint 1,54,108,6,0x00FF00;
			close2;
			cutin "dalle01.bmp",255;
			end;
		}
		else if((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 3) {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "Okay, you've already destroyed the security system, now we've discovered that there's a serious problem.";
			npctalk "Okay, you've already destroyed the security system, now we've discovered that there's a serious problem.";
			emotion ET_HUM;
			next;
			cutin "dalle03.bmp",2;
			mes "[Charleston]";
			mes "It is a virus . . . ";
			next;
			mes "[Charleston]";
			mes "The virus is located in all the gears and main machinery, you must deactivate them to continue with our mission.";
			npctalk "The virus is located in all the gears and main machinery, you must deactivate them to continue with our mission.";
			next;
			mes "[Charleston]";
			mes "I'm marking the points on the map where are the essential appliances that I mentioned before.";
			npctalk "I'm marking the points on the map where are the essential appliances that I mentioned before.";
			viewpoint 1,86,231,7,0x00FF00;
			viewpoint 1,172,196,8,0x00FF00;
			viewpoint 1,126,84,9,0x00FF00;
			setd "."+instance_id(),4;
			donpcevent instance_npcname("Virus#1_00p", instance_id()) + "::OnEnable";
			donpcevent instance_npcname("Virus#2_00p", instance_id()) + "::OnEnable";
			donpcevent instance_npcname("Virus#3_00p", instance_id()) + "::OnEnable";
			donpcevent instance_npcname("panelcount#inst", instance_id()) + "::OnEnable";
			donpcevent instance_npcname("#systemsecurity1", instance_id()) + "::OnEnable";
			close2;
			cutin "dalle03.bmp",255;
			end;
		}
		else if((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 4) {
			cutin "dalle03.bmp",2;
			mes "[Charleston]";
			mes "I'm marking the points on the map where are the essential appliances that I mentioned before.";
			next;
			mes "[Charleston]";
			mes "Destroy viruses to free the main robot access system.";
			viewpoint 1,86,231,7,0x00FF00;
			viewpoint 1,172,196,8,0x00FF00;
			viewpoint 1,126,84,9,0x00FF00;
			close2;
			cutin "dalle03.bmp",255;
			end;
		}
		else if((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 5) {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "The viruses have been destroyed, we can now proceed to unlock the main gear.";
			npctalk "The viruses have been destroyed, we can now proceed to unlock the main gear.";
			next;
			cutin "dalle01.bmp",255;
			mes "[Scientist]";
			mes "This gear is full of scrap metal.";
			donpcevent instance_npcname("Scientist#1_00y", instance_id()) + "::OnChat1";
			next;
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "After unlocking it we will have direct access to where Charleston is located.";
			npctalk "After unlocking it we will have direct access to where Charleston is located.";
			emotion ET_SURPRISE;
			next;
			mes "[Charleston]";
			mes "The big robot...";
			npctalk "The big robot...";
			next;
			cutin "nale03.bmp",0;
			mes "[Charleston No.2]";
			mes "... But Charleston is...";
			donpcevent instance_npcname("Charleston No.2#0_00y", instance_id()) + "::OnChat2";
			next;
			cutin "dalle02.bmp",2;
			mes "[Charleston]";
			mes "I know what you feel, but still we must know what is happening with the great creation of Father";
			npctalk "I know what you feel, but still we must know what is happening with the great creation of Father";
			emotion ET_CRY;
			next;
			cutin "nale03.bmp",0;
			mes "[Charleston No.2]";
			mes "Okay, I'll do my best to get close to that dreadful thing.";
			donpcevent instance_npcname("Charleston No.2#0_00y", instance_id()) + "::OnChat3";
			next;
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "Let's proceed to release in gear!";
			npctalk "Let's proceed to release in gear!";
			disablenpc instance_npcname("Charleston No.2#0_00y");
			enablenpc instance_npcname("Charleston No.2#1_00p");
			next;
			mes "[Charleston]";
			mes "Let's do this fast, we do not know what's down there.";
			npctalk "Let's do this fast, we do not know what's down there.";
			close2;
			disablenpc instance_npcname("Charleston#1_00y");
			enablenpc instance_npcname("Charleston#4_00p");
			cutin "dalle01.bmp",255;
			end;
		}
		
	} else {
		if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 0) {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "Please talk to the Scientist.";
			close2;
			cutin "dalle01.bmp",255;
			end;
		}
		else if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 1) {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "Please talk to the Scientist.";
			close2;
			cutin "dalle01.bmp",255;
			end;
		}
		else if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 2) {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "First you must destroy the security robots, I'll mark them on the map.";
			viewpoint 1,84,226,0,0x00FF00;
			viewpoint 1,126,84,1,0x00FF00;
			viewpoint 1,111,68,2,0x00FF00;
			viewpoint 1,210,181,3,0x00FF00;
			viewpoint 1,183,192,4,0x00FF00;
			viewpoint 1,130,124,5,0x00FF00;
			viewpoint 1,54,108,6,0x00FF00;
			close2;
			cutin "dalle01.bmp",255;
			end;
		}
		else if((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 3) {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "Already released the security system there are still several things that we have to take care of.";
			npctalk "Already released the security system there are still several things that we have to take care of.";
			emotion ET_HUM;
			next;
			mes "[Charleston]";
			mes "If we fail to stop this crisis, the laboratory will collapse at any time.";
			npctalk "If we fail to stop this crisis, the laboratory will collapse at any time.";
			close2;
			cutin "dalle03.bmp",255;
			end;
		}
		else if((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 4) {
			cutin "dalle03.bmp",2;
			mes "[Charleston]";
			mes "We have found several viruses that threaten the factory, go deactivate them.";
			viewpoint 1,86,231,7,0x00FF00;
			viewpoint 1,172,196,8,0x00FF00;
			viewpoint 1,126,84,9,0x00FF00;
			close2;
			cutin "dalle03.bmp",255;
			end;
		}
		else if((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) == 5) {
			cutin "dalle01.bmp",2;
			mes "[Charleston]";
			mes "Please, talk to the Scientist first.";
			close2;
			cutin "dalle01.bmp",255;
			end;
		}
	}
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "Please Father, tell these brave adventurers what to do";
	end;
OnChat2:
	npctalk "All the robots that father has built have gone crazy.";
	end;
OnChat3:
	npctalk "Sure, help us with your great power to defeat the viruses that have infiltrated the beautiful father robots.";
	end;
OnChat4:
	npctalk "If we do not stop them in time the factory could collapse.";
	end;
OnChat5:
	npctalk "The security system is robots that monitor the area, so we take your help.";
	end;
OnChat8:
	setd "."+instance_id(),1;
	emotion ET_QUESTION;
	npctalk "Okay, please come with me to tell you where the robots in the security system are located.";
	end;
OnCompleteSetp1:
	setd "."+instance_id(),3;
	end;
OnCompleteSetp2:
	setd "."+instance_id(),5;
	end;
}

1@mcd,120,224,5	script	Charleston No.2#0_00y	4_F_CHARLESTON02,{
	if((getvariableofnpc(getd("."+instance_id()),instance_npcname("Charleston#1_00y", instance_id()))) < 5) {
		cutin "nale04.bmp",0;
		mes "[Charleston No.2]";
		mes "All this confuses me a lot.";
		emotion ET_CONFUSE;
		next;
		mes "I do not know why we have to go through all this, if only I had the necessary power.";
		close2;
		cutin "nale04.bmp",255;
		end;
	}
	end;

OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat2:
	npctalk "...but... Charleston is...";
	emotion ET_THINK;
	end;
OnChat3:
	npctalk "Okay, I'll do my best to approach that dreadful thing.";
	end;
}

1@mcd,141,214,5	script	Charleston No.2#1_00p	4_F_CHARLESTON02,{
	if (getcharid(0) == getpartyleader(getcharid(1),2)) {
		cutin "nale03.bmp",0;
		mes "[Charleston No.2]";
		mes "The gears down here ... they seem to have something stuck.";
		npctalk "The gears down here ... they seem to have something stuck.";
		emotion ET_ANGER;
		next;
		cutin "dalle01.bmp",2;
		mes "[Charleston]";
		mes "We have to be very careful about what we touch, this can be harmful.";
		donpcevent instance_npcname("Charleston#4_00p", instance_id()) + "::OnChat1";
		next;
		cutin "nale03.bmp",0;
		mes "[Charleston No.2]";
		mes "But what is that ... looks ... a robot.";
		npctalk "But what is that ... looks ... a robot.";
		next;
		mes "[Charleston No.2]";
		mes "There were also robots here!";
		npctalk "There were also robots here!";
		donpcevent instance_npcname("#step34_00p", instance_id()) + "::OnEnable";
		close2;
		cutin "dalle01.bmp",255;
		end;
	}
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "Be very careful with those robots!";
	end;
OnChat2:
	npctalk "But there was more, does not this have no end ?!";
	end;
OnChat3:
	npctalk "As it was to suppose of this legendary factory, they do not stop to leave.";
	end;
OnChat4:
	npctalk "Fast adventurers, defeat the robots";
	end;
OnChat5:
	npctalk "I see that they diminish, go on!";
	end;
OnChat6:
	npctalk "Almost ... Almost ... there are almost none left, they are amazing!";
	end;
OnChat7:
	npctalk "CHAT NOT FOUND, IF YOU READ THIS REPORT TO A GAME MASTER";
	end;
}

1@mcd,146,214,4	script	Charleston#4_00p	4_F_CHARLESTON01,{
	cutin "dalle01.bmp",2;
	mes "[Charleston]";
	mes "We need to clear the Charleston entrance.";
	close2;
	cutin "dalle01.bmp",255;
	end;

OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "We have to be very careful what we touch, this can be harmful.";
	end;
OnChat2:
	npctalk "It can not be, there are robots!";
	end;
OnChat3:
	npctalk "They do not stop going out, that fear!";
	end;
OnChat4:
	npctalk "I see the robots shrink, protect Charleston!";
	end;
}

//Security Mob Char 02
//========================

1@mcd,144,214,0	script	#step34_00p	HIDDEN_WARP_NPC,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	initnpctimer;
	end;
OnTimer2000:
	donpcevent instance_npcname("#1_00ygate6", instance_id()) + "::OnDisable";
	donpcevent instance_npcname("#1_00ygate7", instance_id()) + "::OnDisable";
	end;
OnTimer4000:
	donpcevent instance_npcname("Charleston No.2#1_00p", instance_id()) + "::OnChat1";
	end;
OnTimer7000:
	donpcevent instance_npcname("Charleston#4_00p", instance_id()) + "::OnChat2";
	end;
OnTimer9000:
	donpcevent instance_npcname("Charleston No.2#1_00p", instance_id()) + "::OnChat2";
	end;
OnTimer10000:
	set .@map$, instance_mapname("1@mcd", instance_id());
	set .@label$, instance_npcname("#step34_00p", instance_id()) + "::OnMyMobDead";
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"C-TYPE",3128,5,.@label$;
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"D-TYPE",3128,2,.@label$;
	end;
OnTimer16000:
	donpcevent instance_npcname("Charleston No.2#1_00p", instance_id()) + "::OnChat3";
	end;
OnTimer15000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname("#step34_00p", instance_id())+"::OnMyMobDead";
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"A-TYPE",3128,4,.@label$;
	end;
OnTimer18000:
	donpcevent instance_npcname("Charleston#4_00p", instance_id()) + "::OnChat3";
	end;
OnTimer22000:
	donpcevent instance_npcname("Charleston No.2#1_00p", instance_id()) + "::OnChat4";
	end;
OnTimer23000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname("#step34_00p", instance_id())+"::OnMyMobDead";
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"L-TYPE",3128,2,.@label$;
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"O-TYPE",3128,2,.@label$;
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"B-TYPE",3126,1,.@label$;
	end;
OnTimer25000:
	donpcevent instance_npcname("Charleston No.2#1_00p", instance_id()) + "::OnChat5";
	end;
OnTimer26000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname("#step34_00p", instance_id())+"::OnMyMobDead";
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"T-TYPE",3128,2,.@label$;
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"O-TYPE",3128,2,.@label$;
	end;
OnTimer29000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname("#step34_00p", instance_id())+"::OnMyMobDead";
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"N-TYPE",3128,4,.@label$;
	end;
OnTimer32000:
	donpcevent instance_npcname("Charleston No.2#1_00p", instance_id()) + "::OnChat6";
	end;
OnTimer33000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname("#step34_00p", instance_id())+"::OnMyMobDead";
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"C-TYPE",3128,5,.@label$;
	end;
OnTimer36000:
	donpcevent instance_npcname("Charleston#4_00p", instance_id()) + "::OnChat4";
	end;
OnTimer37000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname("#step34_00p", instance_id())+"::OnMyMobDead";
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"T-TYPE",3128,2,.@label$;
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"O-TYPE",3128,2,.@label$;
	end;
OnTimer40000:
	donpcevent instance_npcname("Charleston No.2#1_00p", instance_id()) + "::OnChat6";
	end;
OnTimer41000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname("#step34_00p", instance_id())+"::OnMyMobDead";
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"C-TYPE",3128,5,.@label$;
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"D-TYPE",3128,2,.@label$;
	end;
OnTimer44000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname("#step34_00p", instance_id())+"::OnMyMobDead2";
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"C-TYPE",3128,2,.@label$;
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"N-TYPE",3126,2,.@label$;
	areamonster .@map$,HIDDEN_WARP_NPC,219,151,207,"T-TYPE",3128,2,.@label$;
	monster .@map$,144,218,"N-TYPE",3127,1,.@label$;
	set .MyMobs,7;
	end;
OnTimer45000:
	stopnpctimer;
	end;
OnMyMobDead:
	end;
OnMyMobDead2:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .MyMobs, .MyMobs-1;
	if (.MyMobs == 0) {
		donpcevent instance_npcname("Charleston No.2#1_00p", instance_id()) + "::OnDisable";
		donpcevent instance_npcname("Charleston#4_00p", instance_id()) + "::OnDisable";
		donpcevent instance_npcname("Charleston No.2#2_00p", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("Charleston#5_00p", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("Scientist#1_00y", instance_id()) + "::OnDisable";
		donpcevent instance_npcname("Scientist#2_00p", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("#step34_00p", instance_id()) + "::OnDisable";
	}
	end;
}

1@mcd,141,214,5	script	Charleston No.2#2_00p	4_F_CHARLESTON02,{
	if (getcharid(0) == getpartyleader(getcharid(1),2)) {
		cutin "dalle01.bmp",2;
		mes "[Charleston]";
		mes "Now we have the free passage to the great Charleston robot.";
		donpcevent instance_npcname("Charleston#5_00p", instance_id()) + "::OnChat1";
		next;
		cutin "nale01.bmp",0;
		mes "[Charleston No.2]";
		mes "Do not think you can do that robot just to have it in front of you!";
		npctalk "Do not think you can do that robot just to have it in front of you!";
		next;
		cutin "dalle01.bmp",2;
		mes "[Charleston]";
		mes "At no time did I think that, did you?";
		donpcevent instance_npcname("Charleston#5_00p", instance_id()) + "::OnChat2";
		next;
		mes "[Charleston]";
		mes "You know that for thinking mechanical people like us, that would be suicide, it would control us.";
		donpcevent instance_npcname("Charleston#5_00p", instance_id()) + "::OnChat3";
		next;
		cutin "nale01.bmp",0;
		mes "[Charleston No.2]";
		mes "Maybe you, but if only I had been allowed to handle the big robot, none of this would have happened.";
		npctalk "Maybe you, but if only I had been allowed to handle the big robot, none of this would have happened.";
		next;
		cutin "dalle01.bmp",255;
		mes "[Scientist]";
		mes "Of course I would never let you handle it, you're a newer version, but more naive.";
		donpcevent instance_npcname("Scientist#2_00p", instance_id()) + "::OnChat1";
		next;
		cutin "nale02.bmp",0;
		mes "[Charleston No.2]";
		mes "How can you say that Father ?!";
		npctalk "How can you say that Father ?!"; 
		next;
		cutin "dalle01.bmp",2;
		mes "[Charleston]";
		mes "Even when you think yourself superior, you are nothing but a simple copy like all of us, accept it.";
		donpcevent instance_npcname("Charleston#5_00p", instance_id()) + "::OnChat4";
		next;
		cutin "dalle01.bmp",255;
		mes "[Scientist]";
		mes "In that you have totally reason.";
		donpcevent instance_npcname("Scientist#2_00p", instance_id()) + "::OnChat2";
		next;
		cutin "dalle01.bmp",2;
		mes "[Charleston]";
		mes "You who have so many airs of superiority, you will never be able to surpass father, nor surpass to the masterpiece Charleston.";
		donpcevent instance_npcname("Charleston#5_00p", instance_id()) + "::OnChat5";
		next;
		cutin "dalle01.bmp",255;
		mes "[Scientist]";
		mes "Charleston! Stop!";
		donpcevent instance_npcname("Scientist#2_00p", instance_id()) + "::OnChat3";
		next;
		cutin "dalle01.bmp",2;
		mes "[Charleston]";
		mes "With all respect towards you father, but she must know your place.";
		donpcevent instance_npcname("Charleston#5_00p", instance_id()) + "::OnChat6";
		next;
		cutin "dalle01.bmp",255;
		mes "[Scientist]";
		mes "......";
		donpcevent instance_npcname("Scientist#2_00p", instance_id()) + "::OnChat4";
		next;
		cutin "nale01.bmp",0;
		mes "[Charleston No.2]";
		mes "... Don't try that ! I do not plan to be used!";
		npctalk "... Don't try that ! I do not plan to be used!";
		donpcevent instance_npcname("Charleston No.2#2_00p", instance_id()) + "::OnDisable";
		next;
		cutin "dalle01.bmp",2;
		mes "[Charleston]";
		mes "Charleston No.2! Stop!";
		donpcevent instance_npcname("Charleston#5_00p", instance_id()) + "::OnChat7";
		next;
		mes "[Charleston]";
		mes "Please help me, or you will do something crazy.";
		donpcevent instance_npcname("Charleston#5_00p", instance_id()) + "::OnChat8";
		close2;
		cutin "dalle01.bmp",255;
		donpcevent instance_npcname("#1_00ygate6", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("#1_00ygate7", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("Charleston#5_00p", instance_id()) + "::OnDisable";
		donpcevent instance_npcname("Charleston#6_00p", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("Charleston No.2#3_00p", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("#step36_00p", instance_id()) + "::OnEnable";
		end;
	}
	end;

OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,146,214,4	script	Charleston#5_00p	4_F_CHARLESTON01,{
	mes "[Charleston]";
	mes "We are getting closer to our goal.";
	close;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "Now we have the free passage to the great Charleston robot.";
	end;
OnChat2:
	npctalk "I've never thought that...Would you?";
	end;
OnChat3:
	npctalk "You know that for thinking mechanical people like us, that would be suicide, it would control us.";
	end;
OnChat4:
	npctalk "Even when you think yourself superior, you are nothing more than a simple copy like all of us, accept it.";
	end;
OnChat5:
	npctalk "You who have so many airs of superiority, you will never be able to surpass father, nor surpass to the masterpiece Charleston.";
	end;
OnChat6:
	npctalk "With all respect towards you father, but she must know your place.";
	end;
OnChat7:
	npctalk "Charleston No.2! Stop!";
	end;
OnChat8:
	npctalk "Please help me, or you will do something crazy.";
	end;
}

1@mcd,143,217,5	script	Scientist#2_00p	4_M_DOCTOR,2,3,{
	mes "[Scientist]";
	mes "Quick, go with the girls to unlock the entrance to Charleston.";
	close;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "Of course I would never let you handle it, you're a newer version, but more naive.";
	end;
OnChat2:
	npctalk "In that you have much reason...";
	end;
OnChat3:
	npctalk "Charleston! Stop.";
	end;
OnChat4:
	npctalk "......";
	end;
}

1@mcd,132,129,4	script	Charleston#6_00p	4_F_CHARLESTON01,{
	cutin "dalle01.bmp",2;
	mes "[Charleston]";
	mes "Charleston must not be reactivated for any reason.";
	close2;
	cutin "dalle01.bmp",255;
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "Please, I just say all this for your sake, that machine should not be reactivated.";
	end;
OnChat2:
	npctalk "I am not lying, before you were born that machine brought destruction to our land!";
	end;
OnChat3:
	npctalk "How do you think your organic body died? She was murdered by that thing!";
	end;
OnChat4:
	npctalk "Of course, why do you think we've been doing all the strenuous research.";
	end;
OnChat5:
	npctalk "Thanks for understanding... sister...";
	end;
}

1@mcd,127,129,5	script	Charleston No.2#3_00p	4_F_CHARLESTON02,{
	cutin "nale01.bmp",0;
	mes "[Charleston No.2]";
	mes "I knew I could not trust Charleston.";
	close2;
	cutin "nale01.bmp",255;
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "Stay away from here, I am determined and I will not stop, I am more than a simple tool.";
	end;
OnChat2:
	npctalk "Why do you lie so much ?!";
	end;
OnChat3:
	npctalk "Destruction?";
	end;
OnChat4:
	npctalk "Eh ... so it is dangerous ....";
	end;
OnChat5:
	npctalk "Okay, I'll do my best not to get too close to that machine.";
	end;
}

1@mcd,128,127,0	script	#step36_00p	HIDDEN_WARP_NPC,1,1,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnTouch:
	if (getcharid(0) == getpartyleader(getcharid(1),2)) {
		initnpctimer;
		disablenpc instance_npcname("#step36_00p");
		end;
	} else {
		end;
	}
OnTimer3000:
	donpcevent instance_npcname("Charleston No.2#3_00p", instance_id()) + "::OnChat1";
	end;
OnTimer6000:
	donpcevent instance_npcname("Charleston#6_00p", instance_id()) + "::OnChat1";
	end;
OnTimer9000:
	donpcevent instance_npcname("Charleston No.2#3_00p", instance_id()) + "::OnChat2";
	end;
OnTimer12000:
	donpcevent instance_npcname("Charleston#6_00p", instance_id()) + "::OnChat2";
	end;
OnTimer15000:
	donpcevent instance_npcname("Charleston No.2#3_00p", instance_id()) + "::OnChat3";
	end;
OnTimer18000:
	donpcevent instance_npcname("Charleston#6_00p", instance_id()) + "::OnChat3";
	end;
OnTimer21000:
	donpcevent instance_npcname("Charleston No.2#3_00p", instance_id()) + "::OnChat4";
	end;
OnTimer24000:
	donpcevent instance_npcname("Charleston#6_00p", instance_id()) + "::OnChat4";
	end;
OnTimer27000:
	donpcevent instance_npcname("Charleston No.2#3_00p", instance_id()) + "::OnChat5";
	end;
OnTimer30000:
	donpcevent instance_npcname("Charleston#6_00p", instance_id()) + "::OnChat5";
	end;
OnTimer33000:
	donpcevent instance_npcname("Charleston#6_00p", instance_id()) + "::OnDisable";
	donpcevent instance_npcname("Charleston No.2#3_00p", instance_id()) + "::OnDisable";
	donpcevent instance_npcname("Charleston#ERp", instance_id()) + "::OnEnable";
	donpcevent instance_npcname("Charleston No.2#BX", instance_id()) + "::OnEnable";
	stopnpctimer;
	end;
}

1@mcd,132,129,4	script	Charleston#ERp	4_F_CHARLESTON01,{
	if (countitem(6213) > 3) {
		mes "[Charleston]";
		mes "Well, we already have enough explosives to blow up the entrance.";
		npctalk "Well, we already have enough explosives to blow up the entrance.";
		delitem 6213,4; //Explosive Powder
		next;
		mes "[Charleston]";
		mes "Get away!";
		npctalk "Get away!";
		specialeffect EF_LORD;
		next;
		cutin "nale01.bmp",0;
		mes "[Charleston No.2]";
		mes "... has it opened?";
		donpcevent instance_npcname("Charleston No.2#BX", instance_id()) + "::OnChat1";
		next;
		cutin "dalle01.bmp",2;
		mes "[Charleston]";
		mes "It seems that if it has been opened.";
		npctalk "It seems that if it has been opened";
		donpcevent instance_npcname("#1_00ygate8", instance_id()) + "::OnEnable";
		next;
		cutin "nale01.bmp",0;
		mes "[Charleston No.2]";
		mes "Ok, let's go.";
		donpcevent instance_npcname("Charleston No.2#BX", instance_id()) + "::OnChat2";
		next;
		donpcevent instance_npcname("Charleston No.2#BX", instance_id()) + "::OnDisable";
		donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("Charleston No.2#4_00p", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("Charleston No .2#BG1", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("Charleston No .3#BG2", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("Charleston#ERp", instance_id()) + "::OnDisable";
		cutin "nale01.bmp",255;
		end;
	} else {
		cutin "dalle01.bmp",2;
		mes "[Charleston]";
		mes "The entrance is sealed, if we only had some ^5533FFExplosive Powder ^000000 to make it fly.";
		close2;
		cutin "dalle01.bmp",255;
		end;	
	}
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,127,129,5	script	Charleston No.2#BX	4_F_CHARLESTON02,{
	cutin "nale01.bmp",0;
	mes "[Charleston No.2]";
	mes "The entrance is blocked...";
	close2;
	cutin "nale01.bmp",255;
	end;

OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "...has it opened?";
	end;
OnChat2:
	npctalk "...Let's go!";
	end;
}

1@mcd,132,148,4	script	Charleston#7_00p	4_F_CHARLESTON01,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "Apparently the robot is in its normal place.";
	end;
OnChat2:
	npctalk "I think we worry about nothing by thinking that the virus could reach it.";
	end;
OnChat3:
	npctalk "I think we should go back to Father to tell him that everything is all right...";
	end;
OnChat4:
	npctalk "What are you talking about ... Do not tell me what you're going to do it, after all?";
	end;
OnChat5:
	npctalk "Stop, you're not powerful enough to handle it, it will control you!";
	end;
OnChat6:
	npctalk "Think clearly about what you are saying!";
	end;
OnChat7:
	npctalk "I don't think I can continue considering you as my sister.";
	end;
OnChat8:
	npctalk "I will do my best to stop you, or the apocalypse will spread to the upper earth!";
	end;
OnChat9:
	npctalk "For some reason this land died years ago!";
	end;
OnChat10:
	npctalk "Ah!...";
	end;
OnChat11:
	npctalk "Don't do that, you'll destroy us all!";
	end;
OnChat12:
	npctalk "Stop!";
	end;
}

1@mcd,127,148,5	script	Charleston No.2#4_00p	4_F_CHARLESTON02,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "It is... Charleston!";
	end;
OnChat2:
	npctalk "I don't think so";	end;
OnChat3:
	npctalk "I'll take my revenge for everything they've put me through.";
	end;
OnChat4:
	npctalk "I will never forgive them !!!";
	end;
}

1@mcd,130,153,5	script	Charleston No .3#BG2	4_F_CHARLESTON03,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,130,153,0	script	Charleston No .2#BG1	CLEAR_NPC,{
	end;

OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	initnpctimer;
	end;
OnHideOn:
	hideonnpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnHideOff:
	hideoffnpc instance_npcname(strnpcinfo(0), instance_id());;
	end;
OnTimer3000:
	donpcevent instance_npcname("Charleston No.2#4_00p", instance_id()) + "::OnChat1";
	end;
OnTimer6000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat1";
	end;
OnTimer9000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat2";
	end;
OnTimer12000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat3";
	end;
OnTimer15000:
	donpcevent instance_npcname("Charleston No.2#4_00p", instance_id()) + "::OnChat2";
	end;
OnTimer18000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat4";
	end;
OnTimer21000:
	donpcevent instance_npcname("Charleston No.2#4_00p", instance_id()) + "::OnChat3";
	end;
OnTimer24000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat5";
	end;
OnTimer27000:
	donpcevent instance_npcname("Charleston No.2#4_00p", instance_id()) + "::OnChat4";
	end;
OnTimer29000:
	donpcevent instance_npcname("Charleston No.2#4_00p", instance_id()) + "::OnDisable";
	end;
OnTimer33000:
	npctalk "Do not think you can stop me.";
	end;
OnTimer36000:
	npctalk "I'm invincible now!";
	end;
OnTimer39000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat6";
	end;
OnTimer42000:
	npctalk "I had never thought as clearly as I do now, sister.";
	end;
OnTimer45000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat7";
	end;
OnTimer48000:
	npctalk "So this is what you really thought?";
	end;
OnTimer51000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat8";
	end;
OnTimer54000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat9";
	end;
OnTimer57000:
	npctalk "Do you think that interests me? Today, I will show the world how powerful Charleston can be";
	end;
OnTimer60000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat10";
	end;
OnTimer63000:
	npctalk "Let me show you sister, what power is concerned!";
	end;
OnTimer66000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat11";
	end;
OnTimer69000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnChat12";
	end;
OnTimer72000:
	donpcevent instance_npcname("Charleston#7_00p", instance_id()) + "::OnDisable";
	hideonnpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnTimer73000:
	hideonnpc instance_npcname("Charleston No .3#BG2", instance_id());
	monster instance_mapname(strnpcinfo(4), instance_id()),130,153,"Charleston No. 3",3124,1,instance_npcname(strnpcinfo(0))+"::OnMyMobDead";
	stopnpctimer;
	end;
OnMyMobDead:
	set .@map$, instance_mapname("1@mcd", instance_id());
	if (mobcount(.@map$,instance_npcname(strnpcinfo(0))+"::OnMyMobDead") < 1) {
		donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("#step58_00p", instance_id()) + "::OnEnable";
		donpcevent instance_npcname("Charleston No .2#BG1", instance_id()) + "::OnDisable";
	}
	end;	
}

1@mcd,130,150,0	script	#step58_00p	HIDDEN_WARP_NPC,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	initnpctimer;
	end;
OnTimer4000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat1";
	end;
OnTimer6000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat1";
	end;
OnTimer9000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat2";
	end;
OnTimer12000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat3";
	end;
OnTimer15000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat2";
	end;
OnTimer18000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat3";
	end;
OnTimer21000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat4";
	end;
OnTimer24000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat4";
	end;
OnTimer27000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat5";
	end;
OnTimer30000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat5";
	end;
OnTimer33000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat6";
	end;
OnTimer36000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat6";
	end;
OnTimer39000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat7";
	end;
OnTimer42000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat7";
	end;
OnTimer45000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat8";
	end;
OnTimer48000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat9";
	end;
OnTimer51000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat10";
	end;
OnTimer54000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat8";
	end;
OnTimer57000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat11";
	end;
OnTimer60000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat9";
	end;
OnTimer63000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat12";
	end;
OnTimer66000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat13";
	end;
OnTimer69000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat14";
	end;
OnTimer71000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat10";
	end;
OnTimer74000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat15";
	end;
OnTimer78000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat16";
	end;
OnTimer81000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat17";
	end;
OnTimer84000:
	donpcevent instance_npcname("Charleston#8_00p", instance_id()) + "::OnChat18";
	end;
OnTimer87000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat11";
	end;
OnTimer90000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnChat12";
	end;
OnTimer91000:
	donpcevent instance_npcname("Charleston No.2#5_00p", instance_id()) + "::OnDisable";
	end;
OnTimer92000:
	donpcevent instance_npcname("#1_00ygate9", instance_id()) + "::OnEnable";
	donpcevent instance_npcname("Scientist#2_00p", instance_id()) + "::OnDisable";
	donpcevent instance_npcname("Scientist#3_00a", instance_id()) + "::OnEnable";
	donpcevent instance_npcname("Charleston No.2#6_00p", instance_id()) + "::OnEnable";
	donpcevent instance_npcname("#step58_00p", instance_id()) + "::OnDisable";
	stopnpctimer;
	end;
}

1@mcd,127,148,5	script	Charleston No.2#5_00p	4_F_CHARLESTON02,{
	cutin "nale01.bmp",0;
	mes "[Charleston No.2]";
	mes "This is not all..";
	next;
	mes "[Charleston No.2]";
	mes "Father ... apologize to father...";
	close2;
	cutin "nale01.bmp",255;
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "No ... I did not think his control was so much.";
	end;
OnChat2:
	npctalk "Please ... forgive me...";
	end;
OnChat3:
	npctalk "T-thanks to you adventurers too, for rescuing me ...";
	end;
OnChat4:
	npctalk "No ... I will not ...";
	end;
OnChat5:
	npctalk "I... swear";
	end;
OnChat6:
	npctalk "???";
	end;
OnChat7:
	npctalk "Of course, I will never get involved in these things again....";
	end;
OnChat8:
	npctalk "I just wanted to be human !!!!";
	end;
OnChat9:
	npctalk "......";
	end;
OnChat10:
	npctalk "I know!!!";
	end;
OnChat11:
	npctalk "... But it costs nothing to keep dreaming ...";
	end;
OnChat12:
	npctalk "Sorry......";
	end;
}

1@mcd,132,148,4	script	Charleston#8_00p	4_F_CHARLESTON01,{
	cutin "dalle04.bmp",2;
	mes "[Charleston]";
	mes "Thanks God you are okay!";
	next;
	cutin "dalle01.bmp",255;
	mes "Do not give me those scares.";
	close;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "What were you thinking about when you got on that machine ?!";
	end;
OnChat2:
	npctalk "You almost die being up there";
	end;
OnChat3:
	npctalk "You do not know how much I got scared";
	end;
OnChat4:
	npctalk "I thought that I would be alone again in this world ...";
	end;
OnChat5:
	npctalk "It's the bad thing about preserving human memories.";
	end;
OnChat6:
	npctalk "I do not want you to do that anymore!";
	end;
OnChat7:
	npctalk "I just want it to be you, me and Father.";
	end;
OnChat8:
	npctalk "You need to promise me that you will never do these things again.";
	end;
OnChat9:
	npctalk "Please do not frighten me like this again!";
	end;
OnChat10:
	npctalk "You do not know what it is to be alone 100 years ...";
	end;
OnChat11:
	npctalk "It is not easy ....";
	end;
OnChat12:
	npctalk "Let's go back to Father.";
	end;
OnChat13:
	npctalk "He will divide you.";
	end;
OnChat14:
	npctalk "Quiet...";
	end;
OnChat15:
	npctalk "Bep------------------------------";
	end;
OnChat16:
	npctalk "What's going on?";
	end;
OnChat17:
	npctalk "My mind....";
	end;
OnChat18:
	npctalk "I'm... dizzy...";
	end;
}

1@mcd,116,213,5	script	Scientist#3_00a	4_M_DOCTOR,{
	mes "[Scientist]";
	mes "So they managed to stop Charleston.";
	close;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,121,215,4	script	Charleston No.2#6_00p	4_F_CHARLESTON02,{
	donpcevent instance_npcname("Charleston No.2#6_00p", instance_id()) + "::OnChat";
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	donpcevent instance_npcname("Charleston No.2#7_00p", instance_id()) + "::OnEnable";
	end;
}

1@mcd,121,215,4	script	Charleston No.2#7_00p	4_F_CHARLESTON02,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	donpcevent instance_npcname("Scientist#3_00a", instance_id()) + "::OnDisable";
	donpcevent instance_npcname("Scientist#4_00a", instance_id()) + "::OnEnable";
	initnpctimer;
	end;
OnTimer3000:
	npctalk "Father ... please forgive me...";
	end;
OnTimer6000:
	donpcevent instance_npcname("Scientist#4_00a", instance_id()) + "::OnChat1";
	end;
OnTimer9000:
	donpcevent instance_npcname("Scientist#4_00a", instance_id()) + "::OnChat2";
	end;
OnTimer12000:
	npctalk "I know father, but I was so frustrated.";
	end;
OnTimer15000:
	donpcevent instance_npcname("Scientist#4_00a", instance_id()) + "::OnChat3";
	end;
OnTimer18000:
	npctalk "Thanks, Dad...";
	end;
OnTimer21000:
	npctalk "Thank you for forgiving me...";
	end;
OnTimer36000:
	donpcevent instance_npcname("Scientist#4_00a", instance_id()) + "::OnChat8";
	end;
OnTimer39000:
	npctalk "!!!!!!";
	end;
OnTimer42000:
	donpcevent instance_npcname("Scientist#4_00a", instance_id()) + "::OnChat9";
	end;
OnTimer45000:
	npctalk "... That mean you are just like us, father.";
	end;
OnTimer48000:
	donpcevent instance_npcname("Scientist#4_00a", instance_id()) + "::OnChat10";
	end;
OnTimer51000:
	donpcevent instance_npcname("Scientist#4_00a", instance_id())+"::OnChat11";
	end;
OnTimer54000:
	npctalk "...Hehe, thank you father.";
	end;
OnTimer57000:
	donpcevent instance_npcname("Scientist#4_00a", instance_id())+"::OnChat12";
	end;
OnTimer60000:
	npctalk "......";
	end;
OnTimer63000:
	npctalk "Thanks for everything, adventurers. I owe everything to you..";
	end;
OnTimer66000:
	donpcevent instance_npcname("Scientist#4_00a", instance_id())+"::OnChat13";
	end;
OnTimer68000:
	donpcevent instance_npcname("Scientist#4_00a", instance_id())+"::OnDisable";
	donpcevent instance_npcname("Scientist#5_00a", instance_id())+"::OnEnable";
	stopnpctimer;
	donpcevent instance_npcname("Charleston No.2#7_00p", instance_id())+"::OnDisable";
	donpcevent instance_npcname("Charleston No.2#8_00p", instance_id())+"::OnEnable";
	end;
}

1@mcd,116,213,5	script	Scientist#4_00a	4_M_DOCTOR,{
	mes "[Scientist]";
	mes "How well they have returned safely.";
	close;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnChat1:
	npctalk "What were you thinking about climbing the tremendous machine.";
	end;
OnChat2:
	npctalk "Maybe your sister and I did not warn you enough.";
	end;
OnChat3:
	npctalk "The important thing is that everything is over.";
	end;
OnChat8:
	npctalk "That's what I promised your mother when you were born, that's why we are machines now";
	end;
OnChat9:
	npctalk "So I can care for eternity.";
	end;
OnChat10:
	npctalk "Of course, how could a father be if he did not understand them.";
	end;
OnChat11:
	npctalk "Also if you think it with logic, I am 100 years older than you.";
	end;
OnChat12:
	npctalk "Please do not do crazy things like that again.";
	end;
OnChat13:
	npctalk "Many thanks...";
	end;
}

1@mcd,121,215,4	script	Charleston No.2#8_00p	4_F_CHARLESTON02,{
	if(charlestonins == 0) {
		cutin "nale04.bmp",0;
		mes "Go talk to the Scientist please, he have something to tell you.";
		close2;
		cutin "nale04.bmp",255;
		end;
	} else {
		cutin "nale04.bmp",0;
		mes "If you do not find Shalosh, I think she was near here, she's a beautiful lady in black.";
		close2;
		cutin "nale04.bmp",255;
		end;
	}
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,116,213,5	script	Scientist#5_00a	4_M_DOCTOR,{
	if(charlestonins == 0) {
		mes "[Scientist]";
		mes "Ey...";
		next;
		mes "[Scientist]";
		mes "Thank you so much for everything you have done for my daughters..";
		next;
		mes "["+strcharinfo(0)+"]";
		mes "Is everything all right now at the factory?";
		next;
		mes "[Scientist]";
		mes "The big robot Charleston was our main concern.";
		next;
		mes "[Scientist]";
		mes "Now that we know that the virus does not affect everything, it has returned to normal.";
		next;
		mes "[Scientist]";
		mes "However, we still do not know the origin of the virus so we can not relax.";
		next;
		mes "["+strcharinfo(0)+"]";
		mes "Does it have to do with the activity of the robots out there?";
		next;
		mes "[Scientist]";
		mes "Certainly, those robots are quite old, Juperos technology was the best decades ago.";
		next;
		mes "[Scientist]";
		mes "But my greed ended up destroying this utopia.";
		next;
		mes "[Scientist]";
		mes "I can not thank you for everything you have done for me and my daughters.";
		next;
		mes "^777777Scientist turns to see his daughters^000000";
		next;
		mes "[Scientist]";
		mes "If it had not, long ago I would have unleashed the chaos.";
		next;
		mes "[Scientist]";
		mes "Thanks. For everything.";
		set charlestonins,1;
		close;
	} else {
		mes "[Scientist]";
		mes "I hope everything is back to normal now.";
		next;
		mes "[Scientist]";
		mes "Please look for ^5533ffShalosh ^000000, and comment on what has happened, she is inside the building.";
		next;
		mes "[Scientist]";
		mes "It is a lady dressed in black, you will recognize her immediately.";
		close;
	}
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,77,167,5	script	Shalosh#1_00a	4_F_SHALOSH,{
	cutin "shaloshi01.bmp",2;
	mes "[Shalosh]";
	mes "......";
	next;
	switch(select("No, nothing...","What do you think of the factory?","Scientist sent me to you"))
	{
		case 1:
			mes "[Shalosh]";
			mes "Do not waste my time.";
			close2;
			cutin "shaloshi01.bmp",255;
			end;
		case 2:
			mes "[Shalosh]";
			mes "I did not expect it to continue working, how well they are here.";
			close2;
			cutin "shaloshi01.bmp",255;
			end;
		case 3:
			if(charlestonins == 0) {
				mes "[Shalosh]";
				mes "Please do not talk nonsense, help stop the crisis and then come with me.";
				close2;
				cutin "shaloshi01.bmp",255;
				end;
			} else {
				mes "[Shalosh]";
				mes "Great job, they have done away with the great robot Charleston.";
				next;
				mes "[Shalosh]";
				mes "I see you collected some junk, have a spare.";
				getitem 6752,3; //Charleston Parts
				erasequest 13184;
				setquest 13186;
				close2;
				cutin "shaloshi01.bmp",255;
				warp "verus04",107,124;
				instance_destroy instance_id();
				end;
			}
	}
OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

//Extra Quest:
//===============
1@mcd,109,219,5	script	Important Machine#1_00a	CLEAR_NPC,{
	//RATHENA
	set .@huntsystem,checkquest(13188,PLAYTIME); //20 Hours
	//HERCULES
	//set .@huntsystem,questprogress(13188,PLAYTIME); //20 Hours
	if (.@huntsystem == -1) {
		//RATHENA
		if (checkquest(13187,HUNTING) == -1) {
		//HERCULES
		//if (questprogress(13187,HUNTING) == 0) {
			mes "[Important Machine]";
			mes "Large number of Steps have appeared in the factory";
			next;
			mes "[Important Machine]";
			mes "If they continue to play, they will cause a system failure.";
			next;
			mes "[Important Machine]";
			mes "Would you help kill 50 Steps?";
			next;
			switch(select("Help","Deny"))
			{
				case 1:
					mes "[Important Machine]";
					mes "Mission start.";
					setquest 13187;
					close;

				case 2:
					close;
			}
		}
		//RATHENA
		if ((checkquest(13187,HUNTING) == 0) || (checkquest(13187,HUNTING) == 1)) {
		//HERCULES
		//if (questprogress(13187,HUNTING) == 1) {
			mes "[Important Machine]";
			mes "Not yet hunted 50 Step";
			close;
		}
		//RATHENA
		else if (checkquest(13187,HUNTING) == 2) {
		//HERCULES
		//else if (questprogress(13187,HUNTING) == 2) {
			mes "[Important Machine]";
			mes "Good work, have your reward.";
			getexp 1200000,360000;
			getitem 6752,1; //Charleston Parts
			erasequest 13187;
			setquest 13188;
			close;
		}
	//HERCULES
	}
	//RATHENA
	else if ((.@huntsystem == 0) || (.@huntsystem == 1)) {
	//HERCULES
	//else if (.@huntsystem == 1) {
		mes "[Important Machine]";
		mes "It is not time for you to take up my mission again.";
		close;
	}
	else if (.@huntsystem == 2) {
		mes "[Important Machine]";
		mes "Large number of Steps have appeared in the factory";
		next;
		mes "[Important Machine]";
			mes "If they continue to play, they will cause a system failure.";
		next;
		mes "[Important Machine]";
			mes "Would you help kill 50 Steps?";
		next;
		switch(select("Help","Deny"))
		{
			case 1:
				mes "[Important Machine]";
				mes "Mission start.";
				erasequest 13188;
				setquest 13187;
				close;
			case 2:
				close;
		}
	}
OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}


//Respawn Mobs
//=============

1@mcd,127,264,0	script	mob#1_00y	HIDDEN_WARP_NPC,4,4,{
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	areamonster .@map$,107,254,115,250,"Kick and Kick",3128,8,.@label$;
	donpcevent instance_npcname("mob#12_00y", instance_id())+"::OnEnable";
	donpcevent instance_npcname("mob#2_00y", instance_id())+"::OnEnable";
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
OnMyMobDead:
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,67,234,0	script	mob#2_00y	HIDDEN_WARP_NPC,4,4,{
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	areamonster .@map$,52,231,60,227,"Kick and Kick",3128,8,.@label$;
	donpcevent instance_npcname("#ccmemorialseal1", instance_id())+"::OnEnable";
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
OnMyMobDead:
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,33,192,0	script	mob#3_00y	HIDDEN_WARP_NPC,4,4,{
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	areamonster .@map$,21,164,30,156,"Kick and Kick",3128,8,.@label$;
	areamonster .@map$,46,87,57,78,"Kick and Kick",3128,8,.@label$;
	donpcevent instance_npcname("#ccmemorialseal2", instance_id())+"::OnEnable";
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
OnMyMobDead:
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,75,59,0	script	mob#4_00y	HIDDEN_WARP_NPC,4,7,{
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	areamonster .@map$,85,51,95,46,"Kick and Kick",3128,8,.@label$;
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
OnMyMobDead:
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,109,33,0	script	mob#5_00y	HIDDEN_WARP_NPC,4,4,{
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	areamonster .@map$,120,29,129,26,"Kick and Kick",3128,8,.@label$;
	areamonster .@map$,226,37,249,18,"Kick and Kick",3128,8,.@label$;
	donpcevent instance_npcname("#ccmemorialseal3", instance_id())+"::OnEnable";
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
OnMyMobDead:
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}
1@mcd,133,49,0	script	mob#6_00y	HIDDEN_WARP_NPC,4,4,{
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	areamonster .@map$,160,57,173,50,"Kick and Kick",3128,8,.@label$;
	areamonster .@map$,188,62,199,73,"Kick and Kick",3128,2,.@label$;
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
OnMyMobDead:
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}
1@mcd,204,74,0	script	mob#7_00y	HIDDEN_WARP_NPC,4,4,{
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	areamonster .@map$,227,202,235,192,"Kick and Kick",3128,8,.@label$;
	areamonster .@map$,272,191,291,172,"Kick and Kick",3128,6,.@label$;
	donpcevent instance_npcname("#ccmemorialseal4", instance_id())+"::OnEnable";
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
OnMyMobDead:
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,204,224,0	script	mob#8_00y	HIDDEN_WARP_NPC,4,5,{
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	areamonster .@map$,130,233,137,235,"Kick and Kick",3128,6,.@label$;
	areamonster .@map$,174,225,207,195,"Kick and Kick",3128,6,.@label$;
	donpcevent instance_npcname("#1_00ygate5", instance_id())+"::OnEnable";
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
OnMyMobDead:
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,175,147,0	script	mob#9_00y	HIDDEN_WARP_NPC,8,4,{
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	areamonster .@map$,117,194,117,190,"Kick and Kick",3128,8,.@label$;
	donpcevent instance_npcname("#1_00ygate6", instance_id())+"::OnEnable";
	donpcevent instance_npcname("#1_00ygate7", instance_id())+"::OnEnable";
	donpcevent instance_npcname("Scientist#1_00y", instance_id())+"::OnEnable";
	donpcevent instance_npcname("Charleston#1_00y", instance_id())+"::OnEnable";
	donpcevent instance_npcname("Charleston No.2#0_00y", instance_id())+"::OnEnable";
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
OnMyMobDead:
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,157,61,0	script	mob#10_00y	HIDDEN_WARP_NPC,4,4,{
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	areamonster .@map$,123,70,133,66,"Kick and Kick",3128,8,.@label$;
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
OnMyMobDead:
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,0,0,0	script	mob#11_00y	HIDDEN_WARP_NPC,{
	end;
OnMyMobDead:
		set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
		set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
		switch(rand(2)) {
		case 0:
			monster .@map$,0,0,"Kick and Kick",3128,1,.@label$;
			break;
		case 1:
			monster .@map$,0,0,"Step",3125,1,.@label$;
			break;
		}
	end;

OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	monster .@map$,0,0,"Kick and Kick",3128,20,.@label$;
	monster .@map$,0,0,"Step",3125,60,.@label$;
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,0,0,0	script	mob#12_00y	HIDDEN_WARP_NPC,{
	end;
OnMyMobDead:
		set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
		set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
		switch(rand(2)) {
		case 0:
			monster .@map$,0,0,"Kick and Kick",3128,1,.@label$;
			break;
		case 1:
			monster .@map$,0,0,"Step",3125,1,.@label$;
			break;
		}
	end;

OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	monster .@map$,0,0,"Kick and Kick",3128,20,.@label$;
	monster .@map$,0,0,"Step",3125,10,.@label$;
	end;
}
// Seals
//=============

1@mcd,23,275,0	script	#ccmemorialseal1	HIDDEN_WARP_NPC,{
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	monster instance_mapname(strnpcinfo(4), instance_id()),23,275,"Kick Step",3127,1,instance_npcname("#ccmemorialseal1", instance_id()) + "::OnMyMobDead";
	end;
OnMyMobDead:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	if (mobcount(.@map$,instance_npcname(strnpcinfo(0))+"::OnMyMobDead") < 1) {
		mapannounce .@map$, "Charleston: One of the viruses has been destroyed, continue like this.",bc_map,"0xFFFF00";
		donpcevent instance_npcname("#1_00ygate1", instance_id())+"::OnEnable";
		donpcevent instance_npcname(strnpcinfo(0))+"::OnDisable";
	}
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,23,275,0	script	#ccmemorialseal2	HIDDEN_WARP_NPC,{
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	monster instance_mapname(strnpcinfo(4), instance_id()),33,59,"Kick Step",3127,1,instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	end;
OnMyMobDead:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	if (mobcount(.@map$,instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead") < 1) {
		mapannounce .@map$, "Charleston: Good job, apparently the machines start to work, look for more viruses.",bc_map,"0xFFFF00";
		donpcevent instance_npcname("#1_00ygate2", instance_id())+"::OnEnable";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	}
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,239,29,0	script	#ccmemorialseal3	HIDDEN_WARP_NPC,{
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	monster instance_mapname(strnpcinfo(4), instance_id()),239,29,"Kick Step",3127,1,instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	end;
OnMyMobDead:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	if (mobcount(.@map$,instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead") < 1) {
		mapannounce .@map$, "Charleston: Looks like there's only one more.",bc_map,"0xFFFF00";
		donpcevent instance_npcname("#1_00ygate3", instance_id())+"::OnEnable";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	}
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,281,184,0	script	#ccmemorialseal4	HIDDEN_WARP_NPC,{
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	monster instance_mapname(strnpcinfo(4), instance_id()),281,184,"Kick Step",3127,1,instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	end;
OnMyMobDead:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	if (mobcount(.@map$,instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead") < 1) {
		mapannounce .@map$, "Charleston: Good work! Come back here!",bc_map,"0xFFFF00";
		donpcevent instance_npcname("#1_00ygate4", instance_id())+"::OnEnable";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	}
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

//Warp portals
//==================

1@mcd,44,211,0,	script	#1_00ygate1	WARPNPC,1,2,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnTouch:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	switch(atoi(replacestr(strnpcinfo(2),"1_00ygate","")))
	{
		case 1: warp .@map$,41,200; break;
		case 2: warp .@map$,65,66; break;
		case 3: warp .@map$,115,50; break;
		case 4: warp .@map$,210,217; break;
		case 5: warp .@map$,211,180; break;
		case 6: warp .@map$,141,207; break;
		case 7: warp .@map$,136,200; break;
		case 8: warp .@map$,129,143; break;
		case 9: warp .@map$,130,121; break;
	}
	end;
}
1@mcd,58,72,0	duplicate(#1_00ygate1)	#1_00ygate2	WARPNPC,1,2
1@mcd,104,50,0	duplicate(#1_00ygate1)	#1_00ygate3	WARPNPC,1,2
1@mcd,218,211,0	duplicate(#1_00ygate1)	#1_00ygate4	WARPNPC,1,2
1@mcd,211,195,0	duplicate(#1_00ygate1)	#1_00ygate5	WARPNPC,1,2
1@mcd,141,199,0	duplicate(#1_00ygate1)	#1_00ygate6	WARPNPC,1,2
1@mcd,142,203,0	duplicate(#1_00ygate1)	#1_00ygate7	WARPNPC,1,2 // Control panel exit
1@mcd,130,127,0	duplicate(#1_00ygate1)	#1_00ygate8	WARPNPC,1,2 // mvp entrance
1@mcd,130,134,0	duplicate(#1_00ygate1)	#1_00ygate9	WARPNPC,1,2 // mvp exit

//System Security Mob
//=======================

1@mcd,0,0,0	script	#systemsecurity	HIDDEN_WARP_NPC,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	monster .@map$,84,226,"Security Robot",3126,1,.@label$;
	monster .@map$,126,84,"Security Robot",3126,1,.@label$;
	monster .@map$,111,68,"Security Robot",3126,1,.@label$;
	monster .@map$,210,181,"Security Robot",3126,1,.@label$;
	monster .@map$,183,192,"Security Robot",3126,1,.@label$;
	monster .@map$,130,124,"Security Robot",3126,1,.@label$;
	monster .@map$,54,108,"Security Robot",3126,1,.@label$;
	set .MyMobs,7;
	end;
OnMyMobDead:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .MyMobs, .MyMobs-1;
	if (.MyMobs == 0) {
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnComplete";
		donpcevent instance_npcname("Charleston#1_00y", instance_id())+"::OnCompleteSetp1";
		mapannounce .@map$, "Charleston: the security system has been deactivated!",bc_map,"0xFFFF00";
	}
		end;
OnComplete:
	initnpctimer;
	end;
OnTimer2000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	mapannounce .@map$, "Charleston: Come back with us!",bc_map,"0xFFFF00";
	end;
OnTimer5000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	mapannounce .@map$, "Charleston: When deactivating the security system many viruses have appeared!",bc_map,"0xFFFF00";
	stopnpctimer;
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,0,0,0	script	#systemsecurity1	HIDDEN_WARP_NPC,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	set .@label$, instance_npcname(strnpcinfo(0), instance_id())+"::OnMyMobDead";
	monster .@map$,86,231,"Security Robot",3127,1,.@label$;
	monster .@map$,172,196,"Security Robot",3127,1,.@label$;
	monster .@map$,126,84,"Security Robot",3127,1,.@label$;
	monster .@map$,100,149,"Security Robot",3127,1,.@label$;
	monster .@map$,158,149,"Security Robot",3127,1,.@label$;
	end;
OnMyMobDead:
	end;
OnComplete:
	initnpctimer;
	end;
OnTimer2000:
	mapannounce .@map$, "Charleston: Without the security robots the system remains open!",bc_map,"0xFFFF00";
	end;
OnTimer5000:
	mapannounce .@map$, "Charleston: This can cause more emergence of robots.",bc_map,"0xFFFF00";
	stopnpctimer;
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

//Panel Controls:
//=================

1@mcd,172,198,5	script	Virus#2_00p	CLEAR_NPC,2,2,{
	end;
OnTouch:
	if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("panelcount#inst", instance_id()))) == 0) {
		mes "Virus deactivated..";
		donpcevent instance_npcname("panelcount#inst", instance_id())+"::OnCheck";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
		close;
	}
	else if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("panelcount#inst", instance_id()))) == 1) {
		mes "Virus deactivated..";
		donpcevent instance_npcname("panelcount#inst", instance_id())+"::OnCheck1";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
		close;
	}
	if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("panelcount#inst", instance_id()))) == 2) {
		mes "Virus deactivated..";
		next;
		mes "Everything seems to work fine now.";
		donpcevent instance_npcname("Charleston#1_00y", instance_id())+"::OnCompleteSetp2";
		donpcevent instance_npcname("panelcount#inst", instance_id())+"::OnComplete";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
		close;
	}
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,126,84,5	script	Virus#3_00p	CLEAR_NPC,2,2,{
	end;
OnTouch:
	if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("panelcount#inst", instance_id()))) == 0) {
		mes "Virus deactivated..";
		donpcevent instance_npcname("panelcount#inst", instance_id())+"::OnCheck";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
		close;
	}
	else if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("panelcount#inst", instance_id()))) == 1) {
		mes "Virus deactivated..";
		donpcevent instance_npcname("panelcount#inst", instance_id())+"::OnCheck1";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
		close;
	}
	else if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("panelcount#inst", instance_id()))) == 2) {
		mes "Virus deactivated..";
		next;
		mes "Apparatus back in operation.";
		donpcevent instance_npcname("Charleston#1_00y", instance_id())+"::OnCompleteSetp2";
		donpcevent instance_npcname("panelcount#inst", instance_id())+"::OnComplete";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
		close;
	}
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,86,231,5	script	Virus#1_00p	CLEAR_NPC,2,2,{
	end;
OnTouch:
	if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("panelcount#inst", instance_id()))) == 0) {
		mes "Virus deactivated..";
		donpcevent instance_npcname("panelcount#inst", instance_id())+"::OnCheck";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
		close;
	}
	else if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("panelcount#inst", instance_id()))) == 1) {
		mes "Virus deactivated..";
		donpcevent instance_npcname("panelcount#inst", instance_id())+"::OnCheck1";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
		close;
	}
	else if ((getvariableofnpc(getd("."+instance_id()),instance_npcname("panelcount#inst", instance_id()))) == 2) {
		mes "Virus deactivated..";
		next;
		mes "Apparatus back in operation.";
		donpcevent instance_npcname("Charleston#1_00y", instance_id())+"::OnCompleteSetp2";
		donpcevent instance_npcname("panelcount#inst", instance_id())+"::OnComplete";
		donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
		close;
	}
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

1@mcd,0,0,0	script	panelcount#inst	HIDDEN_WARP_NPC,{
	end;
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	setd "."+instance_id(),0;
	end;
OnCheck:
	setd "."+instance_id(),1;
	end;
OnCheck1:
	setd "."+instance_id(),2;
	end;
OnComplete:
	initnpctimer;
	end;
OnTimer1000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	mapannounce .@map$, "Charleston : Viruses have been disabled, but something is happening on the gears!.",bc_map,"0xFFFF00";
	end;
OnTimer4000:
	set .@map$, instance_mapname(strnpcinfo(4),  instance_id());
	mapannounce .@map$, "Charleston : Apparently many monsters have been placed in the gears, come here!.",bc_map,"0xFFFF00";
	stopnpctimer;
	donpcevent instance_npcname(strnpcinfo(0), instance_id())+"::OnDisable";
	end;
	
}

//NPC????? (Need mechanic job)??????????!!!!!!!!
//==============================================

1@mcd,176,179,5	script	Newoz#15_00a	4_M_NEWOZ,{
	cutin "nines01.bmp",0;
	mes "[Newoz]";
	mes "Shalosh is in charge of this mission, if something important happens, tell her.";
	close2;
	cutin "nines01.bmp",255;
	end;
OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}
	
1@mcd,114,82,4	script	Iuri#01_00y	4_F_IU,{
	cutin "igu04.bmp",2;
	mes "[Iuri]";
	mes "These monsters are disgusting.";
	close2;
	cutin "igu04.bmp",255;
	end;
OnInstanceInit:
OnEnable:
	enablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
OnDisable:
	disablenpc instance_npcname(strnpcinfo(0), instance_id());
	end;
}

//NPC EQUIP (SEMI-CUSTOM)
//==========================

verus04,64,112,4	script	Charleston Nx#verus1	4_F_CHARLESTON01,{
	cutin "dalle03.bmp",2;
	mes "[Charleston's Clone]";
	mes "After defeating Charleston you can create very powerful objects.";
	next;
	cutin "dalle01.bmp",2;
	mes "[Charleston's Clone]";
	mes "Each of the objects that I will show here occupies ^000000Charleston Parts ^000000, so do not forget it";
	next;
	mes "[Charleston's Clone]";
	mes "Also for the creation of each of these I will charge ^FF0000 3999999 ^000000 Zeny";
	next;
	mes "[Charleston's Clone]";
	mes "What do you want to do?";
	next;
	switch(select("Who can use them?","Create Refoircement Gloves","Crearte Strength Supplement Equip","Upgrade Pile Bunker"))
	{
		case 1:
			cutin "dalle03.bmp",2;
			mes "[Charleston's Clone]";
			mes "Only the ^5533ffMechanic ^000000 can use the equipment of this place.";
			close2;
			cutin "dalle03.bmp",255;
			end;
		case 2:
			mes "[Charleston's Clone]";
			mes "Well, I will use 7 pieces of Charleston and 3999999z.";
			next;
			switch(select("I'll keep it for later.","Do it"))
			{
				case 1:
					mes "[Charleston's Clone]";
					mes "Your choice.";
					close2;
					cutin "dalle01.bmp",255;
					end;
				case 2:
					if (Zeny >= 3999999 && countitem(6752) >= 7) {
						set Zeny, Zeny - 3999999;
						delitem 6752,7;
						mes "[Charleston's Clone]";
						mes "Thanks";
						getitem 15111,1; //Reinforced Parts - Gloves
						close;
					} else {
						mes "[Charleston's Clone]";
						mes "You don't have the requirements.";
						close2;
						cutin "dalle01.bmp",255;
						end;
					}
			}
		case 3:
			mes "[Charleston's Clone]";
			mes "Well, I will use 7 pieces of Charleston and 3999999z.";
			next;
			switch(select("I'll keep it for later.","Do it"))
			{
				case 1:
					mes "[Charleston's Clone]";
					mes "Your choice.";
					close2;
					cutin "dalle01.bmp",255;
					end;
				case 2:
					if (Zeny >= 3999999 && countitem(6752) >= 7) {
						set Zeny, Zeny - 3999999;
						mes "[Charleston's Clone]";
						mes "Thanks";
						getitem 15110,1; //Strength Supplement Equipment
						close;
					} else {
						mes "[Charleston's Clone]";
						mes "You don't have the requirements.";
						close2;
						cutin "dalle01.bmp",255;
						end;
					}
			}
		case 4:
			mes "[Charleston's Clone]";
			mes "Thanks to Charleston you can improve the Pile Bunker, but in manufacturing can fail and lose everything.";
			next;
			mes "[Charleston's Clone]";
			mes "Each Pile Bunker is different, please choose the one you want";
			next;
			switch(select("Pile Bunker S","Pile Bunker P","Pile Bunker T"))
			{
				case 1:
					mes "[Charleston's Clone]";
					mes "To make the Pile Bunker S I will use 1 Pile Bunker, 300 Crushed Can Iron Plate, 15 Failed Engine.";
					next;
					switch(select("No thanks.","Do it"))
					{
						case 1:
							mes "[Charleston's Clone]";
							mes "Your choice.";
							close2;
							cutin "dalle01.bmp",255;
							end;
						case 2:
							if (countitem(1549) == 1) && (countitem(6751) > 299) && (countitem(6750) > 14) {
								specialeffect2 EF_REPAIRWEAPON;
								progressbar "ffff00",5;
								set .@pileS_ran,rand(1,10);
								if (.@piles_ran < 5) {
									specialeffect2 EF_REFINEOK;
									delitem 1549,1; // Pile Bunker
									delitem 6751,300; //Crushed Can Iron Plate
									delitem 6750,15; //Failed Engine
									getitem 16030,1; //Pile Bunker S
									close2;
									cutin "dalle01.bmp",255;
									end;
								} else {
									specialeffect2 EF_REFINEFAIL;
									delitem 1549,1; // Pile Bunker
									delitem 6751,300; //Crushed Can Iron Plate
									delitem 6750,15; //Failed Engine
									close2;
									cutin "dalle01.bmp",255;
									end;
								}
							} else {
								mes "[Charleston's Clone]";
								mes "You don't have the requirements.";
								close2;
								cutin "dalle01.bmp",255;
								end;
							}
					}
				case 2:
					mes "[Charleston's Clone]";
					mes "To make the Pile Bunker P I will use 1 Pile Bunker, 300 Crushed Can Iron Plate, 15 Failed Engine";
					next;
					switch(select("No thanks.","Do it"))
					{
						case 1:
							mes "[Charleston's Clone]";
							mes "Your choice.";
							close2;
							cutin "dalle01.bmp",255;
							end;
						case 2:
							if (countitem(1549) == 1) && (countitem(6751) > 299) && (countitem(6750) > 14) {
								specialeffect2 EF_REPAIRWEAPON;
								progressbar "ffff00",5;
								set .@pileS_ran,rand(1,10);
								if (.@piles_ran < 5) {
									specialeffect2 EF_REFINEOK;
									delitem 1549,1; // Pile Bunker
									delitem 6751,300; //Crushed Can Iron Plate
									delitem 6750,15; //Failed Engine
									getitem 16031,1; //Pile Bunker P
									close2;
									cutin "dalle01.bmp",255;
									end;
								} else {
									specialeffect2 EF_REFINEFAIL;
									delitem 1549,1; // Pile Bunker
									delitem 6751,300; //Crushed Can Iron Plate
									delitem 6750,15; //Failed Engine
									close2;
									cutin "dalle01.bmp",255;
									end;
								}
							} else {
								mes "[Charleston's Clone]";
								mes "You don't have the requirements.";
								close2;
								cutin "dalle01.bmp",255;
								end;
							}
					}
				case 3:
					mes "[Charleston's Clone]";
					mes "To make the Pile Bunker T I will use 1 Pile Bunker, 300 Crushed Can Iron Plate, 15 Failed Engine";
					next;
					switch(select("No thanks.","Do it"))
					{
						case 1:
							mes "[Charleston's Clone]";
							mes "Your choice.";
							close2;
							cutin "dalle01.bmp",255;
							end;
						case 2:							
								if (countitem(1549) == 1) && (countitem(6751) > 299) && (countitem(6750) > 14) {
								specialeffect2 EF_REPAIRWEAPON;
								progressbar "ffff00",5;
								set .@pileS_ran,rand(1,10);
								if (.@piles_ran < 5) {
									specialeffect2 EF_REFINEOK;
									delitem 1549,1; // Pile Bunker
									delitem 6751,300; //Crushed Can Iron Plate
									delitem 6750,15; //Failed Engine
									getitem 16032,1; //Pile Bunker T
									close2;
									cutin "dalle01.bmp",255;
									end;
								} else {
									specialeffect2 EF_REFINEFAIL;
									delitem 1549,1; // Pile Bunker
									delitem 6751,300; //Crushed Can Iron Plate
									delitem 6750,15; //Failed Engine
									close2;
									cutin "dalle01.bmp",255;
									end;
								}
							} else {
								mes "[Charleston's Clone]";
								mes "You don't have the requirements.";
								close2;
								cutin "dalle01.bmp",255;
								end;
							}
					}
			}
	}
}